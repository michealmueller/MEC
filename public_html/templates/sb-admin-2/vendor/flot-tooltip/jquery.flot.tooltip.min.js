(function(b){var a={tooltip:{show:false,cssClass:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:true,snap:true,lines:false,clickTips:false,onHover:function(f,e){},$compat:false}};a.tooltipOpts=a.tooltip;var c=function(e){this.tipPosition={x:0,y:0};this.init(e)};c.prototype.init=function(j){var g=this;var h=b.plot.plugins.length;this.plotPlugins=[];if(h){for(var i=0;i<h;i++){this.plotPlugins.push(b.plot.plugins[i].name)}}j.hooks.bindEvents.push(function(m,l){g.plotOptions=m.getOptions();if(typeof(g.plotOptions.tooltip)==="boolean"){g.plotOptions.tooltipOpts.show=g.plotOptions.tooltip;g.plotOptions.tooltip=g.plotOptions.tooltipOpts;delete g.plotOptions.tooltipOpts}if(g.plotOptions.tooltip.show===false||typeof g.plotOptions.tooltip.show==="undefined"){return}g.tooltipOptions=g.plotOptions.tooltip;if(g.tooltipOptions.$compat){g.wfunc="width";g.hfunc="height"}else{g.wfunc="innerWidth";g.hfunc="innerHeight"}var n=g.getDomElement();b(m.getPlaceholder()).bind("plothover",k);if(g.tooltipOptions.clickTips){b(m.getPlaceholder()).bind("plotclick",e)}g.clickmode=false;b(l).bind("mousemove",f)});j.hooks.shutdown.push(function(m,l){b(m.getPlaceholder()).unbind("plothover",k);b(m.getPlaceholder()).unbind("plotclick",e);m.removeTooltip();b(l).unbind("mousemove",f)});function f(l){var m={};m.x=l.pageX;m.y=l.pageY;j.setTooltipPosition(m)}function e(m,n,l){if(!g.clickmode){k(m,n,l);if(g.getDomElement().is(":visible")){b(j.getPlaceholder()).unbind("plothover",k);g.clickmode=true}}else{b(j.getPlaceholder()).bind("plothover",k);j.hideTooltip();g.clickmode=false}}function k(p,s,o){var l=function(u,t,w,v){return Math.sqrt((w-u)*(w-u)+(v-t)*(v-t))};var n=function(F,C,v,G,t,E,u){if(u&&!(u=function(H,O,J,L,I,K){if(typeof J!=="undefined"){return{x:J,y:O}}else{if(typeof L!=="undefined"){return{x:H,y:L}}}var N,M=-1/((K-L)/(I-J));return{x:N=(I*(H*M-O+L)+J*(H*-M+O-K))/(M*(I-J)+L-K),y:M*N-M*H+O}}(F,C,v,G,t,E),u.x>=Math.min(v,t)&&u.x<=Math.max(v,t)&&u.y>=Math.min(G,E)&&u.y<=Math.max(G,E))){var z=l(F,C,v,G),w=l(F,C,t,E);return z>w?w:z}else{var D=G-E,B=t-v,A=v*E-G*t;return Math.abs(D*F+B*C+A)/Math.sqrt(D*D+B*B)}};if(o){j.showTooltip(o,g.tooltipOptions.snap?o:s)}else{if(g.plotOptions.series.lines.show&&g.tooltipOptions.lines===true){var r=g.plotOptions.grid.mouseActiveRadius;var q={distance:r+1};var m=s;b.each(j.getData(),function(w,x){var A=0,z=-1;for(var u=1;u<x.data.length;u++){if(x.data[u-1][0]<=s.x&&x.data[u][0]>=s.x){A=u-1;z=u}}if(z===-1){j.hideTooltip();return}var y={x:x.data[A][0],y:x.data[A][1]},C={x:x.data[z][0],y:x.data[z][1]};var t=n(x.xaxis.p2c(s.x),x.yaxis.p2c(s.y),x.xaxis.p2c(y.x),x.yaxis.p2c(y.y),x.xaxis.p2c(C.x),x.yaxis.p2c(C.y),false);if(t<q.distance){var B=l(y.x,y.y,s.x,s.y)<l(s.x,s.y,C.x,C.y)?A:z;var v=x.datapoints.pointsize;var E=[s.x,y.y+((C.y-y.y)*((s.x-y.x)/(C.x-y.x)))];var D={datapoint:E,dataIndex:B,series:x,seriesIndex:w};q={distance:t,item:D};if(g.tooltipOptions.snap){m={pageX:x.xaxis.p2c(E[0]),pageY:x.yaxis.p2c(E[1])}}}});if(q.distance<r+1){j.showTooltip(q.item,m)}else{j.hideTooltip()}}else{j.hideTooltip()}}}j.setTooltipPosition=function(o){var n=g.getDomElement();var l=n.outerWidth()+g.tooltipOptions.shifts.x;var m=n.outerHeight()+g.tooltipOptions.shifts.y;if((o.x-b(window).scrollLeft())>(b(window)[g.wfunc]()-l)){o.x-=l}if((o.y-b(window).scrollTop())>(b(window)[g.hfunc]()-m)){o.y-=m}if(isNaN(o.x)){g.tipPosition.x=g.tipPosition.xPrev}else{g.tipPosition.x=o.x;g.tipPosition.xPrev=o.x}if(isNaN(o.y)){g.tipPosition.y=g.tipPosition.yPrev}else{g.tipPosition.y=o.y;g.tipPosition.yPrev=o.y}};j.showTooltip=function(o,l,n){var p=g.getDomElement();var m=g.stringFormat(g.tooltipOptions.content,o);if(m===""){return}p.html(m);j.setTooltipPosition({x:l.pageX,y:l.pageY});p.css({left:g.tipPosition.x+g.tooltipOptions.shifts.x,top:g.tipPosition.y+g.tooltipOptions.shifts.y}).show();if(typeof g.tooltipOptions.onHover==="function"){g.tooltipOptions.onHover(o,p)}};j.hideTooltip=function(){g.getDomElement().hide().html("")};j.removeTooltip=function(){g.getDomElement().remove()}};c.prototype.getDomElement=function(){var e=b("<div>");if(this.tooltipOptions&&this.tooltipOptions.cssClass){e=b("."+this.tooltipOptions.cssClass);if(e.length===0){e=b("<div />").addClass(this.tooltipOptions.cssClass);e.appendTo("body").hide().css({position:"absolute"});if(this.tooltipOptions.defaultTheme){e.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"})}}}return e};c.prototype.stringFormat=function(z,C){var i=/%p\.{0,1}(\d{0,})/;var o=/%s/;var w=/%c/;var g=/%lx/;var D=/%ly/;var A=/%x\.{0,1}(\d{0,})/;var h=/%y\.{0,1}(\d{0,})/;var l="%x";var F="%y";var B="%ct";var f="%n";var q,m,k,s,u;if(typeof C.series.threshold!=="undefined"){q=C.datapoint[0];m=C.datapoint[1];k=C.datapoint[2]}else{if(typeof C.series.curvedLines!=="undefined"){q=C.datapoint[0];m=C.datapoint[1]}else{if(typeof C.series.lines!=="undefined"&&C.series.lines.steps){q=C.series.datapoints.points[C.dataIndex*2];m=C.series.datapoints.points[C.dataIndex*2+1];k=""}else{q=C.series.data[C.dataIndex][0];m=C.series.data[C.dataIndex][1];k=C.series.data[C.dataIndex][2]}}}if(C.series.label===null&&C.series.originSeries){C.series.label=C.series.originSeries.label}if(typeof(z)==="function"){z=z(C.series.label,q,m,C)}if(typeof(z)==="boolean"&&!z){return""}if(k){z=z.replace(B,k)}if(typeof(C.series.percent)!=="undefined"){s=C.series.percent}else{if(typeof(C.series.percents)!=="undefined"){s=C.series.percents[C.dataIndex]}}if(typeof s==="number"){z=this.adjustValPrecision(i,z,s)}if(C.series.hasOwnProperty("pie")){if(typeof(C.series.data[0][1]!=="undefined")){u=C.series.data[0][1]}}if(typeof u==="number"){z=z.replace(f,u)}if(typeof(C.series.label)!=="undefined"){z=z.replace(o,C.series.label)}else{z=z.replace(o,"")}if(typeof(C.series.color)!=="undefined"){z=z.replace(w,C.series.color)}else{z=z.replace(w,"")}if(this.hasAxisLabel("xaxis",C)){z=z.replace(g,C.series.xaxis.options.axisLabel)}else{z=z.replace(g,"")}if(this.hasAxisLabel("yaxis",C)){z=z.replace(D,C.series.yaxis.options.axisLabel)}else{z=z.replace(D,"")}if(this.isTimeMode("xaxis",C)&&this.isXDateFormat(C)){z=z.replace(A,this.timestampToDate(q,this.tooltipOptions.xDateFormat,C.series.xaxis.options))}if(this.isTimeMode("yaxis",C)&&this.isYDateFormat(C)){z=z.replace(h,this.timestampToDate(m,this.tooltipOptions.yDateFormat,C.series.yaxis.options))}if(typeof q==="number"){z=this.adjustValPrecision(A,z,q)}if(typeof m==="number"){z=this.adjustValPrecision(h,z,m)}if(typeof C.series.xaxis.ticks!=="undefined"){var E;if(this.hasRotatedXAxisTicks(C)){E="rotatedTicks"}else{E="ticks"}var e=C.dataIndex+C.seriesIndex;for(var j in C.series.xaxis[E]){if(C.series.xaxis[E].hasOwnProperty(e)&&!this.isTimeMode("xaxis",C)){var v=(this.isCategoriesMode("xaxis",C))?C.series.xaxis[E][e].label:C.series.xaxis[E][e].v;if(v===q){z=z.replace(A,C.series.xaxis[E][e].label.replace(/\$/g,"$$$$"))}}}}if(typeof C.series.yaxis.ticks!=="undefined"){for(var r in C.series.yaxis.ticks){if(C.series.yaxis.ticks.hasOwnProperty(r)){var t=(this.isCategoriesMode("yaxis",C))?C.series.yaxis.ticks[r].label:C.series.yaxis.ticks[r].v;if(t===m){z=z.replace(h,C.series.yaxis.ticks[r].label.replace(/\$/g,"$$$$"))}}}}if(typeof C.series.xaxis.tickFormatter!=="undefined"){z=z.replace(l,C.series.xaxis.tickFormatter(q,C.series.xaxis).replace(/\$/g,"$$"))}if(typeof C.series.yaxis.tickFormatter!=="undefined"){z=z.replace(F,C.series.yaxis.tickFormatter(m,C.series.yaxis).replace(/\$/g,"$$"))}return z};c.prototype.isTimeMode=function(f,e){return(typeof e.series[f].options.mode!=="undefined"&&e.series[f].options.mode==="time")};c.prototype.isXDateFormat=function(e){return(typeof this.tooltipOptions.xDateFormat!=="undefined"&&this.tooltipOptions.xDateFormat!==null)};c.prototype.isYDateFormat=function(e){return(typeof this.tooltipOptions.yDateFormat!=="undefined"&&this.tooltipOptions.yDateFormat!==null)};c.prototype.isCategoriesMode=function(f,e){return(typeof e.series[f].options.mode!=="undefined"&&e.series[f].options.mode==="categories")};c.prototype.timestampToDate=function(f,e,g){var h=b.plot.dateGenerator(f,g);return b.plot.formatDate(h,e,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)};c.prototype.adjustValPrecision=function(i,g,h){var f;var e=g.match(i);if(e!==null){if(RegExp.$1!==""){f=RegExp.$1;h=h.toFixed(f);g=g.replace(i,h)}}return g};c.prototype.hasAxisLabel=function(f,e){return(b.inArray("axisLabels",this.plotPlugins)!==-1&&typeof e.series[f].options.axisLabel!=="undefined"&&e.series[f].options.axisLabel.length>0)};c.prototype.hasRotatedXAxisTicks=function(e){return(b.inArray("tickRotor",this.plotPlugins)!==-1&&typeof e.series.xaxis.rotatedTicks!=="undefined")};var d=function(e){new c(e)};b.plot.plugins.push({init:d,options:a,name:"tooltip",version:"0.8.5"})})(jQuery);